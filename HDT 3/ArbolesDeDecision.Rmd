---
title: "Arboles de Decision"
author: "Javier Ramirez Cospin"
date: "4/3/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


``` {r }
install.packages("plyr")
```

``` {r }
library(plyr)
library(dplyr)
```

### Carga y Limpieza de Datos
``` {r }
datos <- read.csv("train.csv",TRUE,",")
datos <- datos %>% 
  mutate(Alley = coalesce(Alley,"NO"),
         FireplaceQu = coalesce(FireplaceQu,"NO"),
         PoolQC = coalesce(PoolQC,"NO"),
         Fence = coalesce(Fence,"NO"),
         MiscFeature = coalesce(MiscFeature,"NO"),
         MiscFeature = coalesce(LandSlope,"NO"))
```

### Analisis Exploratorio Variable MSZoning
Obtener la media del precio para las casas en relacion a su variable MSZoning
``` {r }
# Obtener los grupos de casas en relacion a su variable MSZoning
msZoning <- table(datos$MSZoning)
# Promedio de precio para cada uno de los grupos obtenidos anteriormente
fvMean <- sum(datos$SalePrice[datos$MSZoning == "FV"]) / sum(datos$MSZoning == "FV")
rhMean <- sum(datos$SalePrice[datos$MSZoning == "RH"]) / sum(datos$MSZoning == "RH")
rlMean <- sum(datos$SalePrice[datos$MSZoning == "RL"]) / sum(datos$MSZoning == "RL")
rmMean <- sum(datos$SalePrice[datos$MSZoning == "RM"]) / sum(datos$MSZoning == "RM")
means <- c("FV" = fvMean,"RH" = rhMean,"RL" = rlMean,"RM" = rmMean)
# Barplot del resultado
barplot(means,
        main="Media de precio variable MSZoning",
        ylim=c(0,250000),
        ylab="Media",
        xlab="Zoning",
        col="lightgreen")
```

### Analisis Exploratorio Variable LotArea
Obtener los precios para las Top 25 casas con las propiedades mas grandes
``` {r }
lotArea <- select(datos,LotArea,SalePrice)
lotArea <- lotArea[with(lotArea,order(-LotArea)),]
lotArea <- lotArea[1:25,]
barplot(t(as.matrix(lotArea)),
        main="Precio de Top 25 Propiedades mas grandes",
        xlab="TamaÃ±o Propiedad",
        ylab="Precio",
        ylim=c(0,700000))
```

### Analisis Exploratorio Variable LandSlope
Obtener la media del precio basado en la variable LandSlope (inclinacion del terreno)
``` {r }
landSlope <- table(datos$LandSlope)
gtlMean <- sum(datos$SalePrice[datos$LandSlope == "Gtl"]) / sum(datos$LandSlope == "Gtl")
modMean <- sum(datos$SalePrice[datos$LandSlope == "Mod"]) / sum(datos$LandSlope == "Mod")
sevMean <- sum(datos$SalePrice[datos$LandSlope == "Sev"]) / sum(datos$LandSlope == "Sev")
means = c("GTL" = gtlMean,"Mod" = modMean,"Sev" = sevMean)
barplot(means,
        main="Media de precio variable LandSlope",
        ylim=c(0,210000),
        ylab="Media",
        xlab="Inclinacion",
        col="lightblue")
```

### Analisis Exploratorio Variable LandContour
Obtener la media del precio basado en la variable LandContour
``` {r }
landContour <- table(datos$LandContour)
bnkMean <- sum(datos$SalePrice[datos$LandContour == "Bnk"]) / sum(datos$LandContour == "Bnk")
hlsMean <- sum(datos$SalePrice[datos$LandContour == "HLS"]) / sum(datos$LandContour == "HLS")
lowMean <- sum(datos$SalePrice[datos$LandContour == "Low"]) / sum(datos$LandContour == "Low")
lvlMean <- sum(datos$SalePrice[datos$LandContour == "Lvl"]) / sum(datos$LandContour == "Lvl")
means = c("BNK" = bnkMean,"HLS" = hlsMean,"Low" = lowMean,"Lvl" = lvlMean)
barplot(means,
        main="Media de precio variable Contour",
        ylim=c(0,250000),
        ylab="Media",
        xlab="Contour",
        col="orange")
```

### Analisis Exploratorio Variable ExterQual
Obtener la media del precio en base a la calidad de los materiales del exterior
``` {r }
exterQual <- table(datos$ExterQual)
exMean <- sum(datos$SalePrice[datos$ExterQual == "Ex"]) / sum(datos$ExterQual == "Ex")
faMean <- sum(datos$SalePrice[datos$ExterQual == "Fa"]) / sum(datos$ExterQual == "Fa")
gdMean <- sum(datos$SalePrice[datos$ExterQual == "Gd"]) / sum(datos$ExterQual == "Gd")
taMean <- sum(datos$SalePrice[datos$ExterQual == "TA"]) / sum(datos$ExterQual == "TA")
means <- c("Ex" = exMean,"FA" = faMean,"GD" = gdMean,"TA" = taMean)
means
barplot(means,
        main="Media de precio variable ExterQual",
        ylim=c(0,400000),
        ylab="Media",
        xlab="Calidad Exterior",
        col="yellow")
```

### Analisis Exploratorio Variable ExterCond
Obtener la media del precio en base a la condicion de los materiales del exterior de la casa
``` {r }
exterCond <- table(datos$ExterCond)
exMean <- sum(datos$SalePrice[datos$ExterCond == "Ex"]) / sum(datos$ExterCond == "Ex")
faMean <- sum(datos$SalePrice[datos$ExterCond == "Fa"]) / sum(datos$ExterCond == "Fa")
gdMean <- sum(datos$SalePrice[datos$ExterCond == "Gd"]) / sum(datos$ExterCond == "Gd")
taMean <- sum(datos$SalePrice[datos$ExterCond == "TA"]) / sum(datos$ExterCond == "TA")
poMean <- sum(datos$SalePrice[datos$ExterCond == "Po"]) / sum(datos$ExterCond == "Po")
means <- c("Ex" = exMean,"FA" = faMean,"GD" = gdMean,"TA" = taMean,"Po" = poMean)
barplot(means,
        main="Media de precio variable ExterCond",
        ylim=c(0,205000),
        ylab="Media",
        xlab="Condicion del Exterior",
        col="red")
```