---
title: "Proyecto Analisis Exploratorio"
author: "Javier Ramirez Cospin"
date: "15/3/2021"
output: html_document
---
### Inicializacion de archivo
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Instalacion de Librerias
``` {r }

```
### Carga de librerias
``` {r }
library('readxl')
library('ggplot2')
```
### Limpieza de global environment variables (OPCIONAL)
``` {r }
rm(list = ls())
```
### Carga de Datos
Ingresar el path donde se encuentran los archivos de Divorcios y Matrimonios
``` {r }
path = getwd()
# Carga de datos de matrimonios 2001 - 2017
divorcios2010 <- read_excel(paste(path,"/DivorciosBD/Divorcios2001-2010.xls",sep=""),
                              sheet=2,skip=1,col_names=TRUE)
divorcios2011 <- read_excel(paste(path,"/DivorciosBD/Divorcios2011.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2012 <- read_excel(paste(path,"/DivorciosBD/Divorcios2012.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2013 <- read_excel(paste(path,"/DivorciosBD/Divorcios2013.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2014 <- read_excel(paste(path,"/DivorciosBD/Divorcios2014.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2015 <- read_excel(paste(path,"/DivorciosBD/Divorcios2015.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2016 <- read_excel(paste(path,"/DivorciosBD/Divorcios2016.xls",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
divorcios2017 <- read_excel(paste(path,"/DivorciosBD/Divorcios2017.xlsx",sep=""),
                              sheet=4,skip=1,col_names=TRUE)
# Carga de datos de divorcios 2001 - 2017
matrimonios2010 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2001-2010.xls",sep=""),
                              sheet=2,skip=1,col_names=TRUE)
matrimonios2011 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2011.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2012 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2012.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2013 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2013.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2014 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2014.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2015 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2015.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2016 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2016.xlsx",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
matrimonios2017 <- read_excel(paste(path,"/MatrimoniosBD/Matrimonios2017.xlsx",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
# Carga de datos de violencia intrafamiliar 2008 - 2017
violenciaSalario2008 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2008.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2008 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2008.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2009 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2009.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2009 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2009.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2010 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2010.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2010 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2010.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2011 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2011.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2011 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2011.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2012 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2012.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2012 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2012.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2013 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2013.xlsx",sep=""),
                              sheet=12,skip=7,col_names=TRUE)
violenciaNoSalario2013 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2013.xlsx",sep=""),
                              sheet=13,skip=6,col_names=TRUE)
violenciaSalario2014 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2014.xlsx",sep=""),
                              sheet=13,skip=7,col_names=TRUE)
violenciaNoSalario2014 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2014.xlsx",sep=""),
                              sheet=14,skip=6,col_names=TRUE)
violenciaSalario2015 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2015.xlsx",sep=""),
                              sheet=13,skip=7,col_names=TRUE)
violenciaNoSalario2015 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2015.xlsx",sep=""),
                              sheet=14,skip=6,col_names=TRUE)
violenciaSalario2016 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2016.xlsx",sep=""),
                              sheet=13,skip=7,col_names=TRUE)
violenciaNoSalario2016 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2016.xlsx",sep=""),
                              sheet=14,skip=6,col_names=TRUE)
violenciaSalario2017 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2017.xlsx",sep=""),
                              sheet=13,skip=7,col_names=TRUE)
violenciaNoSalario2017 <- read_excel(paste(path,"/ViolenciaBD/ViolenciaIntrafamiliar2017.xlsx",sep=""),
                              sheet=14,skip=6,col_names=TRUE)
# Carga de datos violencia pro mes de ocurrencia 2011 - 2013
violenciaMeses2011 <- read_excel(paste(path,"/DivorciosBD/Divorcios2011.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
violenciaMeses2012 <- read_excel(paste(path,"/DivorciosBD/Divorcios2012.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
violenciaMeses2013 <- read_excel(paste(path,"/DivorciosBD/Divorcios2013.xls",sep=""),
                              sheet=6,skip=1,col_names=TRUE)
# Carga de divorcios por ocupacion de la mujer y del hombre 2012
violenciaOcupacion2012 <- read_excel(paste(path,"/DivorciosBD/Divorcios2012.xls",sep=""),
                                     sheet=5,skip=2,col_names=TRUE)
```
### Analisis Exploratorio General Matrimonios y Divorcios
``` {r }
# Años 2001 - 2017
years <- c('2001','2002','2003','2004','2005','2006','2007','2008','2009','2010',
           '2011','2012','2013','2014','2015','2016','2017')
# Datos generales divorcios 2001 - 2017
dYear2001 <- divorcios2010$'2001'[1]
dYear2002 <- divorcios2010$'2002'[1]
dYear2003 <- divorcios2010$'2003'[1]
dYear2004 <- divorcios2010$'2004'[1]
dYear2005 <- divorcios2010$'2005'[1]
dYear2006 <- divorcios2010$'2006'[1]
dYear2007 <- divorcios2010$'2007'[1]
dYear2008 <- divorcios2010$'2008'[1]
dYear2009 <- divorcios2010$'2009'[1]
dYear2010 <- divorcios2010$'2010'[1]
dYear2011 <- divorcios2011$Total[1]
dYear2012 <- divorcios2012$Total[1]
dYear2013 <- divorcios2013$Total[1]
dYear2014 <- divorcios2014$Total[1]
dYear2015 <- divorcios2015$Total[1]
dYear2016 <- divorcios2016$Total[1]
dYear2017 <- divorcios2017$Total[1]
divorciosGenerales <- c(dYear2001,dYear2002,dYear2003,dYear2004,dYear2005,dYear2006,dYear2007,
                        dYear2008,dYear2009,dYear2010,dYear2011,dYear2012,dYear2013,dYear2014,
                        dYear2015,dYear2016,dYear2017)
# Datos generales matrimonios 2001 - 2017
mYear2001 <- matrimonios2010$'2001'[1]
mYear2002 <- matrimonios2010$'2002'[1]
mYear2003 <- matrimonios2010$'2003'[1]
mYear2004 <- matrimonios2010$'2004'[1]
mYear2005 <- matrimonios2010$'2005'[1]
mYear2006 <- matrimonios2010$'2006'[1]
mYear2007 <- matrimonios2010$'2007'[1]
mYear2008 <- matrimonios2010$'2008'[1]
mYear2009 <- matrimonios2010$'2009'[1]
mYear2010 <- matrimonios2010$'2010'[1]
mYear2011 <- matrimonios2011$Total[1]
mYear2012 <- matrimonios2012$Total[1]
mYear2013 <- matrimonios2013$Total[1]
mYear2014 <- matrimonios2014$Total[1]
mYear2015 <- matrimonios2015$Total[1]
mYear2016 <- matrimonios2016$Total[1]
mYear2017 <- matrimonios2017$Total[1]
matrimoniosGenerales <- c(mYear2001,mYear2002,mYear2003,mYear2004,mYear2005,mYear2006,mYear2007,
                          mYear2008,mYear2009,mYear2010,mYear2011,mYear2012,mYear2013,mYear2014,
                          mYear2015,mYear2016,mYear2017)
# Creacion de data frame con divorcios 2001 - 2017 y  matrimonios 2001 - 2017
divorciosMatrimoniosGenerales <- data.frame(Year = years,
                                  Divorcios = divorciosGenerales,
                                  Matrimonios = matrimoniosGenerales)
# Graficas
{ggplot() + 
        geom_line(aes(y = Divorcios,x = Year,group = 1),
                  data = divorciosMatrimoniosGenerales) + 
        geom_vline(xintercept = 12,linetype="dashed",col="black")}
{ggplot() + 
        geom_line(aes(y = Matrimonios,x = Year,group = 1),
                  data = divorciosMatrimoniosGenerales) +
        geom_vline(xintercept = 12,linetype="dashed",col="black")}
```
### Analisis Exploratorio General Violencia Intrafamiliar
``` {r }
# Años
years <- c('2008','2009','2010','2011','2012','2013','2014','2015','2016','2017')
# Hombres sin Salario
hSinSalario2008 <- violenciaNoSalario2008$Total[8]
hSinSalario2009 <- violenciaNoSalario2009$Total[8]
hSinSalario2010 <- violenciaNoSalario2010$Total[8]
hSinSalario2011 <- violenciaNoSalario2011$Total[8]
hSinSalario2012 <- violenciaNoSalario2012$Total[8]
hSinSalario2013 <- violenciaNoSalario2013$Total[8]
hSinSalario2014 <- violenciaNoSalario2014$Total[9]
hSinSalario2015 <- violenciaNoSalario2015$Total[9]
hSinSalario2016 <- violenciaNoSalario2016$Total[8]
hSinSalario2017 <- violenciaNoSalario2017$Total[9]
hombresSinSalario <- c(hSinSalario2008,hSinSalario2009,hSinSalario2010,hSinSalario2011,hSinSalario2012,
                       hSinSalario2013,hSinSalario2014,hSinSalario2015,hSinSalario2016,hSinSalario2017)
# Mujeres sin salario
mSinSalario2008 <- violenciaNoSalario2008$Total[15]
mSinSalario2009 <- violenciaNoSalario2009$Total[15]
mSinSalario2010 <- violenciaNoSalario2010$Total[15]
mSinSalario2011 <- violenciaNoSalario2011$Total[15]
mSinSalario2012 <- violenciaNoSalario2012$Total[15]
mSinSalario2013 <- violenciaNoSalario2013$Total[15]
mSinSalario2014 <- violenciaNoSalario2014$Total[17]
mSinSalario2015 <- violenciaNoSalario2015$Total[17]
mSinSalario2016 <- violenciaNoSalario2016$Total[15]
mSinSalario2017 <- violenciaNoSalario2017$Total[17]
mujeresSinSalario <- c(mSinSalario2008,mSinSalario2009,mSinSalario2010,mSinSalario2011,mSinSalario2012,
                       mSinSalario2013,mSinSalario2014,mSinSalario2015,mSinSalario2016,mSinSalario2017)
# Hombres con Salario
hSalario2008 <- violenciaSalario2008$Hombres[1]
hSalario2009 <- violenciaSalario2009$Hombres[1]
hSalario2010 <- violenciaSalario2010$Hombres[1]
hSalario2011 <- violenciaSalario2011$Hombres[1]
hSalario2012 <- violenciaSalario2012$Hombres[1]
hSalario2013 <- violenciaSalario2013$Hombres[1]
hSalario2014 <- violenciaSalario2014$Hombres[1]
hSalario2015 <- violenciaSalario2015$Hombres[1]
hSalario2016 <- violenciaSalario2016$Hombres[1]
hSalario2017 <- violenciaSalario2017$Hombres[1]
hombresConSalario <- c(hSalario2008,hSalario2009,hSalario2010,hSalario2011,hSalario2012,
                       hSalario2013,hSalario2014,hSalario2015,hSalario2016,hSalario2017)
# Mujeres con Salario
mSalario2008 <- violenciaSalario2008$Mujeres[1]
mSalario2009 <- violenciaSalario2009$Mujeres[1]
mSalario2010 <- violenciaSalario2010$Mujeres[1]
mSalario2011 <- violenciaSalario2011$Mujeres[1]
mSalario2012 <- violenciaSalario2012$Mujeres[1]
mSalario2013 <- violenciaSalario2013$Mujeres[1]
mSalario2014 <- violenciaSalario2014$Mujeres[1]
mSalario2015 <- violenciaSalario2015$Mujeres[1]
mSalario2016 <- violenciaSalario2016$Mujeres[1]
mSalario2017 <- violenciaSalario2017$Mujeres[1]
mujeresConSalario <- c(mSalario2008,mSalario2009,mSalario2010,mSalario2011,mSalario2012,
                       mSalario2013,mSalario2014,mSalario2015,mSalario2016,mSalario2017)
# Creacion de data frame con victimas hombres (con y sin salario) y victimas mujeres (con y sin salario)
violenciaSalariosHombresMujeres <- data.frame(Year = years,
                                              Hombres_Con_Salario = hombresConSalario,
                                              Mujeres_Con_Salario = mujeresConSalario,
                                              Hombres_Sin_Salario = hombresSinSalario,
                                              Mujeres_Sin_Salario = mujeresSinSalario)
# Grafica Violencia Hombres y Mujeres sin Salario
{plot(violenciaSalariosHombresMujeres$Hombres_Sin_Salario,type="o",col="red",ylim=c(0,25000),main="Violencia Intrafamiliar Hombres y Mujeres Sin Salario 2008 - 2017",ylab="No. Incidentes",xlab="Años",xaxt="n")
lines(violenciaSalariosHombresMujeres$Mujeres_Sin_Salario,type="o",col="blue")
legend(6,12000,legend=c("Hombres","Mujeres"),
       col=c("red","blue"),lty=1.2,cex=0.8)
axis(1,1:10,years)}
# Grafica Violencia Hombres y Mujeres con Salario
{plot(violenciaSalariosHombresMujeres$Hombres_Con_Salario,type="o",col="red",ylim=c(0,10000),main="Violencia Intrafamiliar Hombres y Mujeres Con Salario 2008 - 2017",ylab="No. Incidentes",xlab="Años",xaxt="n")
lines(violenciaSalariosHombresMujeres$Mujeres_Con_Salario,type="o",col="blue")
legend(5,6500,legend=c("Hombres","Mujeres"),
       col=c("red","blue"),lty=1.2,cex=0.8)
axis(1,1:10,years)}
```


### Analisis Exploratorio General Nacimientos 2009 - 2017
``` {r }

```
### Analisis Exploratorio Violencia Intrafamiliar Meses de ocurrencia 2011 - 2013
``` {r }
# Meses del año
months <- c("Enero","Febrero","Marzo","Abril","Mayo","Junio",
            "Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre")
# Numero de divorcios por mes 2011 - 2013
meses2011 <- c(violenciaMeses2011$Enero[1],violenciaMeses2011$Febrero[1],violenciaMeses2011$Marzo[1],
               violenciaMeses2011$Abril[1],violenciaMeses2011$Mayo[1],violenciaMeses2011$Junio[1],
               violenciaMeses2011$Julio[1],violenciaMeses2011$Agosto[1],violenciaMeses2011$Septiembre[1],
               violenciaMeses2011$Octubre[1],violenciaMeses2011$Noviembre[1],violenciaMeses2011$Diciembre[1])

meses2012 <- c(violenciaMeses2012$Enero[1],violenciaMeses2012$Febrero[1],violenciaMeses2012$Marzo[1],
               violenciaMeses2012$Abril[1],violenciaMeses2012$Mayo[1],violenciaMeses2012$Junio[1],
               violenciaMeses2012$Julio[1],violenciaMeses2012$Agosto[1],violenciaMeses2012$Septiembre[1],
               violenciaMeses2012$Octubre[1],violenciaMeses2012$Noviembre[1],violenciaMeses2012$Diciembre[1])

meses2013 <- c(violenciaMeses2013$Enero[1],violenciaMeses2013$Febrero[1],violenciaMeses2013$Marzo[1],
               violenciaMeses2013$Abril[1],violenciaMeses2013$Mayo[1],violenciaMeses2013$Junio[1],
               violenciaMeses2013$Julio[1],violenciaMeses2013$Agosto[1],violenciaMeses2013$Septiembre[1],
               violenciaMeses2013$Octubre[1],violenciaMeses2013$Noviembre[1],violenciaMeses2013$Diciembre[1])

mesesViolencia <- data.frame(Mes = months,
                             Año_2011 = meses2011,
                             Año_2012 = meses2012,
                             Año_2013 = meses2013)
mesesViolencia
# Grafica de ocurrencia por mes 2011 - 20|3
{plot(mesesViolencia$Año_2011,type="o",col="darkmagenta",ylab="No. Divorcios",xlab="",main="No. Divorcios por mes 2011 - 2013",ylim=c(200,600),xaxt="n")
lines(mesesViolencia$Año_2012,type="o",col="forestgreen")
lines(mesesViolencia$Año_2013,type="o",col="darkorange3")
legend(6,300,legend=c("2011","2012","2013"),
       col=c("darkmagenta","forestgreen","darkorange3"),lty=1.2,cex=0.8)
axis(1,1:12,months,las=2)}
```
### Analisis Exploratorio Ocupaciones Hombres y Mujeres 2012
``` {r }
# Ocupaciones
ocupaciones <- c("Militares","Directores","Cientificos","Tecnicos","Auxiliar",
                 "Vendedores","Agricultores","Artesanos","Operadores",
                 "Elemental","No especificada","Ignorado")
# Ocupaiones mujeres 2012
mujeresMilitares2012 <- violenciaOcupacion2012$`Ocupaciones militares`[1]
mujeresDirectoras2012 <- violenciaOcupacion2012$`Directores y gerentes`[1]
mujeresCientificas2012 <- violenciaOcupacion2012$`Profesionales científicos e intelectuales`[1]
mujeresTecnicas2012 <- violenciaOcupacion2012$`Técnicos y profesionales de nivel medio`[1]
mujeresApoyo2012 <- violenciaOcupacion2012$`Personal de apoyo administrativo`[1]
mujeresVendedoras2012 <- violenciaOcupacion2012$`Trabajadores de los servicios y vendedores de comercios y mercados`[1]
mujeresAgricultoras2012 <- violenciaOcupacion2012$`Agricultores y trabajadores calificados agropecuarios, forestales y pesqueros`[1]
mujeresArtesanas2012 <- violenciaOcupacion2012$`Oficiales, operarios y artesanos de artes mecánicas y de otros oficios`[1]
mujeresOperadoras2012 <- violenciaOcupacion2012$`Operadores de intalaciones y máquinas y ensambladores`[1]
mujeresElementales2012 <- violenciaOcupacion2012$`Ocupaciones elementales`[1]
mujeresNoEspecificadas2012 <- violenciaOcupacion2012$`Ocupación  no especificada`[1]
mujeresIgnoradas2012 <- violenciaOcupacion2012$Ignorado[1]
ocupacionesMujeres2012 <- c(mujeresMilitares2012,mujeresDirectoras2012,mujeresCientificas2012,
                            mujeresTecnicas2012,mujeresApoyo2012,mujeresVendedoras2012,
                            mujeresAgricultoras2012,mujeresArtesanas2012,mujeresOperadoras2012,
                            mujeresElementales2012,mujeresNoEspecificadas2012,mujeresIgnoradas2012)
# Ocupaciones hombres 2012
hombresMilitares2012 <- violenciaOcupacion2012$Total[2]
hombresDirectores2012 <- violenciaOcupacion2012$Total[3]
hombresCientificos2012 <- violenciaOcupacion2012$Total[4]
hombresTecnicos2012 <- violenciaOcupacion2012$Total[5]
hombresApoyo2012 <- violenciaOcupacion2012$Total[6]
hombresVendedores2012 <- violenciaOcupacion2012$Total[7]
hombresAgricultores2012 <- violenciaOcupacion2012$Total[8]
hombresArtesanos2012 <- violenciaOcupacion2012$Total[9]
hombresOperadores2012 <- violenciaOcupacion2012$Total[10]
hombresElementales2012 <- violenciaOcupacion2012$Total[11]
hombresNoEspecificados2012 <- violenciaOcupacion2012$Total[12]
hombresIgnorados2012 <- violenciaOcupacion2012$Total[13]
ocupacionesHombres2012 <- c(hombresMilitares2012,hombresDirectores2012,hombresCientificos2012,
                            hombresTecnicos2012,hombresApoyo2012,hombresVendedores2012,
                            hombresAgricultores2012,hombresArtesanos2012,hombresOperadores2012,
                            hombresElementales2012,hombresNoEspecificados2012,hombresIgnorados2012)
# Creacion de data frame
ocupaciones2012 <- data.frame(Ocupaciones = ocupaciones,
                              Mujeres = ocupacionesMujeres2012,
                              Hombres = ocupacionesHombres2012)
# Histograma Mujeres
barplot(ocupaciones2012$Mujeres,
        main="Ocupaciones de Mujeres Divorciadas 2012",
        ylim=c(0,2000),
        names.arg = ocupaciones2012$Ocupaciones,
        ylab="No. Mujeres",
        las=2,
        col="darksalmon",
        cex.names=0.6)
# Histograma Hombres
barplot(ocupaciones2012$Hombres,
        main="Ocupaciones de Hombres Divorciados 2012",
        ylim=c(0,2500),
        names.arg = ocupaciones2012$Ocupaciones,
        ylab="No. Hombres",
        las=2,
        col="deepskyblue3",
        cex.names=0.6)
```